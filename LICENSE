Modified from Yangqing Jia's caffe code:
https://github.com/BVLC/Caffe/

Copyright  Yangqing Jia

All rights reserved.
